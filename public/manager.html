<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grok API 管理面板</title>
    <link rel="stylesheet" href="/static/manager.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 Grok API 管理面板</h1>
            <p>管理 SSO Token 和系统配置</p>
            <div class="header-actions">
                <button onclick="refreshData()" class="btn btn-secondary">🔄 刷新</button>
                <button onclick="logout()" class="btn btn-danger">🚪 退出</button>
            </div>
        </div>
        
        <div class="section">
            <h2>📊 系统状态</h2>
            <div class="stats" id="stats">
                <div class="stat-card loading">
                    <div class="stat-number">-</div>
                    <div>加载中...</div>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>⚙️ Key 调用模式</h2>
            <div class="form-group">
                <label class="switch-label">
                    <span>调用模式:</span>
                    <label class="switch">
                        <input type="checkbox" id="keyModeSwitch">
                        <span class="slider"></span>
                    </label>
                    <span id="keyModeLabel">轮询模式</span>
                </label>
            </div>
            <div class="form-group" id="usageLimitGroup" style="display: none;">
                <label for="usageLimit">使用次数限制 (1-100):</label>
                <input type="number" id="usageLimit" min="1" max="100" value="20">
                <small>在单Key循环模式下，每个token使用指定次数后切换到下一个</small>
            </div>
            <div class="mode-description" id="modeDescription">
                <p><strong>轮询模式：</strong>每个token使用一次后立即切换到下一个token进行循环</p>
            </div>
            <button onclick="updateKeyMode()" class="btn">💾 保存配置</button>
        </div>
        
        <div class="section">
            <h2>➕ 添加 Token</h2>
            <div class="form-group">
                <label for="tokenType">Token 类型:</label>
                <select id="tokenType">
                    <option value="normal">普通 Token</option>
                    <option value="super">超级 Token</option>
                </select>
                <small>超级Token拥有更高的请求频率限制</small>
            </div>
            <div class="form-group">
                <label for="tokenValue">SSO Token:</label>
                <textarea id="tokenValue" rows="3" placeholder="请输入完整的 Cookie 字符串，包含 sso= 部分&#10;例如: sso=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9..."></textarea>
                <small>请确保包含完整的sso cookie值</small>
            </div>
            <button onclick="addToken()" class="btn">➕ 添加 Token</button>
        </div>
        
        <div class="section">
            <h2>📋 Token 列表</h2>
            <div class="token-controls">
                <button onclick="loadTokens()" class="btn btn-secondary">🔄 刷新列表</button>
                <button onclick="exportTokens()" class="btn btn-secondary">📤 导出配置</button>
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importTokens(event)">
                <button onclick="document.getElementById('importFile').click()" class="btn btn-secondary">📥 导入配置</button>
            </div>
            <div id="tokenList" class="token-list">
                <div class="loading-placeholder">
                    <div class="spinner"></div>
                    <p>加载中...</p>
                </div>
            </div>
        </div>
        
        <div class="section">
            <h2>📈 使用统计</h2>
            <div id="modelStats" class="model-stats">
                <!-- 模型统计将在这里显示 -->
            </div>
        </div>
    </div>
    
    <!-- 通知组件 -->
    <div id="notification" class="notification"></div>
    
    <!-- 确认对话框 -->
    <div id="confirmDialog" class="modal">
        <div class="modal-content">
            <h3>确认操作</h3>
            <p id="confirmMessage"></p>
            <div class="modal-actions">
                <button onclick="closeConfirmDialog()" class="btn btn-secondary">取消</button>
                <button onclick="confirmAction()" class="btn btn-danger">确认</button>
            </div>
        </div>
    </div>
    
    <script src="/static/manager.js"></script>
</body>
</html>
